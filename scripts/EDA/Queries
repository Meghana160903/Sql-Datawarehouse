---find the first order and last order and differnce 

select min(order_date),max(order_date),
datediff(month,min(order_date),max(order_date))
from gold.fact_sales

---find the youngest and oldest customers

select
min(datediff(year,birthdate,current_date)) as youngest,
max(datediff(year,birthdate,current_date)) as oldest 
from  gold.dim_customers

--customers from each  country

select country,count(customer_key) 
from  gold.dim_customers
group by country 
order by count(customer_key)  desc

--find the total customers by gender 

select gender,count(customer_key) 
from gold.dim_customers
group by gender

--find the total customers by catergory 

select category,
count(product_key)
from gold.dim_products
group by category 
order by count(product_key) desc 

--find the total adn avg revenue per category

select p.category,sum(s.sales_amount) as total_amount,
avg(s.sales_amount) as avg_amount
from gold.dim_products p 
join gold.fact_sales s 
on p.product_key = s.product_key
group by p.category

----find the total revenue per each customer

select c.customer_key,c.first_name,sum(s.sales_amount) as total_amount
from gold.dim_customers c 
left join gold.fact_sales s 
on c.customer_key = s.customer_key 
group by c.customer_key,c.first_name
order by sum(s.sales_amount) desc

select * from gold.fact_sales

--- total items sold per each country

select c.country,sum(s.quantity) 
from gold.dim_customers c 
left join gold.fact_sales s  
on c.customer_key = s.customer_key
group by c.country

----display top five highest revenue generating products 

select top 5 p.product_name,sum(sales_amount) as total_revenue
from gold.dim_products p 
join gold.fact_sales s 
on p.product_key = s.product_key 
group by p.product_name
order by sum(sales_amount) desc 

----top 10 high revenue customers 

select top 10 c.customer_key,c.first_name,sum(sales_amount) as total_revenue
from gold.dim_customers c 
join gold.fact_sales s 
on c.customer_key = s.customer_key 
group by c.first_name,c.customer_key
order by sum(sales_amount) desc 


